"use strict";(globalThis["webpackChunkdo_it"]=globalThis["webpackChunkdo_it"]||[]).push([[722],{8722:(e,l,a)=>{a.r(l),a.d(l,{default:()=>q});var t=a(1758),i=a(8790);const d={key:0},o={key:1};function n(e,l,a,n,s,r){const c=(0,t.g2)("q-card"),u=(0,t.g2)("q-td"),m=(0,t.g2)("q-badge"),b=(0,t.g2)("q-btn"),g=(0,t.g2)("q-table"),p=(0,t.g2)("q-page"),k=(0,t.g2)("q-card-section"),f=(0,t.g2)("q-input"),v=(0,t.g2)("q-card-actions"),h=(0,t.g2)("q-dialog"),_=(0,t.g2)("q-icon"),F=(0,t.gN)("close-popup");return(0,t.uX)(),(0,t.CE)(t.FK,null,[l[14]||(l[14]=(0,t.Lk)("link",{rel:"stylesheet",href:"https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"},null,-1)),(0,t.bF)(p,{class:"q-pa-md bg-white"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",null,[(0,t.bF)(c,{class:"q-pa-md no-shadow q-mb-md cardd",bordered:""},{default:(0,t.k6)((()=>l[8]||(l[8]=[(0,t.Lk)("p",{class:"text-weight-bold texttitle text text-h6 text-black"}," All Devices ",-1),(0,t.Lk)("p",{class:"text-weight-bold text-caption text-grey-5 text"}," View and manage all registered devices from this section. ",-1)]))),_:1}),(0,t.Lk)("div",null,[(0,t.bF)(c,{class:"q-pa-md no-shadow q-mb-md cardd",bordered:""},{default:(0,t.k6)((()=>[(0,t.bF)(g,{title:"Data perangkat",rows:s.device,columns:s.columns,"row-key":"id",flat:"",bordered:"",dense:""},{"body-cell-uid_rfid":(0,t.k6)((e=>[(0,t.bF)(u,{props:e},{default:(0,t.k6)((()=>l[9]||(l[9]=[(0,t.eW)(" ***** ")]))),_:2},1032,["props"])])),"body-cell-status":(0,t.k6)((e=>[(0,t.bF)(u,{props:e},{default:(0,t.k6)((()=>[(0,t.bF)(m,{color:"valid"===e.row.status?"green":"red",align:"center",dense:""},{default:(0,t.k6)((()=>[(0,t.eW)((0,i.v_)(e.row.status),1)])),_:2},1032,["color"])])),_:2},1032,["props"])])),"body-cell-masuk":(0,t.k6)((e=>[(0,t.bF)(u,{props:e},{default:(0,t.k6)((()=>[(0,t.eW)((0,i.v_)(r.formatToWIB(e.row.masuk)),1)])),_:2},1032,["props"])])),"body-cell-keluar":(0,t.k6)((e=>[(0,t.bF)(u,{props:e},{default:(0,t.k6)((()=>[e.row.keluar?((0,t.uX)(),(0,t.CE)("span",d,(0,i.v_)(r.formatToWIB(e.row.keluar)),1)):((0,t.uX)(),(0,t.CE)("span",o," belum absen keluar "))])),_:2},1032,["props"])])),"body-cell-created_at":(0,t.k6)((e=>[(0,t.bF)(u,{props:e},{default:(0,t.k6)((()=>[(0,t.eW)((0,i.v_)(r.formatToWIB(e.row.created_at)),1)])),_:2},1032,["props"])])),"body-cell-aksi":(0,t.k6)((l=>[(0,t.bF)(u,{align:"center"},{default:(0,t.k6)((()=>[(0,t.bF)(b,{color:"primary",icon:"edit",dense:"",flat:"",round:"",onClick:e=>r.editPerangkat(l.row)},null,8,["onClick"]),(0,t.bF)(b,{color:"negative",icon:"delete",dense:"",flat:"",round:"",onClick:a=>e.deleteAbsensi(l.row)},null,8,["onClick"])])),_:2},1024)])),_:1},8,["rows","columns"])])),_:1})])])])),_:1}),(0,t.bF)(h,{modelValue:s.editDialog,"onUpdate:modelValue":l[5]||(l[5]=e=>s.editDialog=e),persistent:""},{default:(0,t.k6)((()=>[(0,t.bF)(c,{style:{"min-width":"400px"}},{default:(0,t.k6)((()=>[(0,t.bF)(k,null,{default:(0,t.k6)((()=>l[10]||(l[10]=[(0,t.Lk)("div",{class:"text-h6"},"Edit Device",-1)]))),_:1}),(0,t.bF)(k,{class:"q-pt-none q-gutter-md"},{default:(0,t.k6)((()=>[(0,t.bF)(f,{modelValue:s.editForm.nama_device,"onUpdate:modelValue":l[0]||(l[0]=e=>s.editForm.nama_device=e),label:"Nama Device",dense:"",clearable:""},null,8,["modelValue"]),(0,t.bF)(f,{modelValue:s.editForm.uid_device,"onUpdate:modelValue":l[1]||(l[1]=e=>s.editForm.uid_device=e),label:"UID Device",dense:"",clearable:""},null,8,["modelValue"]),(0,t.bF)(f,{modelValue:s.editForm.mac_address,"onUpdate:modelValue":l[2]||(l[2]=e=>s.editForm.mac_address=e),label:"MAC Address",dense:"",clearable:""},null,8,["modelValue"]),(0,t.bF)(f,{modelValue:s.editForm.latitude,"onUpdate:modelValue":l[3]||(l[3]=e=>s.editForm.latitude=e),modelModifiers:{number:!0},label:"Latitude",type:"number",dense:"",clearable:"",rules:[e=>null!==e&&void 0!==e||"Latitude wajib diisi"]},null,8,["modelValue","rules"]),(0,t.bF)(f,{modelValue:s.editForm.longitude,"onUpdate:modelValue":l[4]||(l[4]=e=>s.editForm.longitude=e),modelModifiers:{number:!0},label:"Longitude",type:"number",dense:"",clearable:"",rules:[e=>null!==e&&void 0!==e||"Longitude wajib diisi"]},null,8,["modelValue","rules"])])),_:1}),(0,t.bF)(v,{align:"right"},{default:(0,t.k6)((()=>[(0,t.bo)((0,t.bF)(b,{flat:"",label:"Batal"},null,512),[[F]]),(0,t.bF)(b,{color:"primary",label:"Simpan",onClick:r.submitEdit},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,t.bF)(h,{modelValue:s.confirmDeleteDialog,"onUpdate:modelValue":l[7]||(l[7]=e=>s.confirmDeleteDialog=e)},{default:(0,t.k6)((()=>[(0,t.bF)(c,null,{default:(0,t.k6)((()=>[(0,t.bF)(k,{class:"row items-center q-pb-none"},{default:(0,t.k6)((()=>[(0,t.bF)(_,{name:"warning",color:"red",class:"q-mr-sm"}),l[11]||(l[11]=(0,t.Lk)("span",{class:"text-h6"},"Konfirmasi Hapus",-1))])),_:1}),(0,t.bF)(k,null,{default:(0,t.k6)((()=>[l[12]||(l[12]=(0,t.eW)(" Apakah kamu yakin ingin menghapus device ")),(0,t.Lk)("strong",null,(0,i.v_)(s.selectedDevice?.device_name),1),l[13]||(l[13]=(0,t.eW)("? "))])),_:1}),(0,t.bF)(v,{align:"right"},{default:(0,t.k6)((()=>[(0,t.bo)((0,t.bF)(b,{flat:"",label:"Batal",color:"primary"},null,512),[[F]]),(0,t.bF)(b,{flat:"",label:"Hapus",color:"negative",onClick:l[6]||(l[6]=l=>e.confirmDelete())})])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}const s={components:{},data(){return{loggedInUserId:null,confirmDeleteDialog:!1,selectedDevice:null,editForm:{id:null,nama_device:"",uid_device:"",mac_address:"",latitude:null,longitude:null},editDialog:!1,intervalId:null,device:[],columns:[{name:"id",label:"ID",field:"id",align:"left",sortable:!0},{name:"nama_device",label:"Nama",field:"nama_device",align:"left",sortable:!0},{name:"uid_device",label:"UID Perangkat",field:"uid_device",align:"left",sortable:!0},{name:"mac_address",label:"Mac Address",field:"mac_address",align:"left",sortable:!0},{name:"created_at",label:"Tanggal",field:"created_at",align:"left",sortable:!0},{name:"aksi",label:"Aksi",align:"center"}]}},methods:{async fetchDevice(){this.$q.loadingBar.start();try{const e=await this.$api.get("device");this.device=e.data,console.log(this.device)}catch(e){this.$q.notify({type:"negative",message:"Gagal load pengguna"})}finally{this.$q.loadingBar.stop()}},formatToWIB(e){return new Date(e).toLocaleString("id-ID",{timeZone:"Asia/Jakarta"})},editPerangkat(e){this.editForm={...e},console.log(e),this.editDialog=!0},deleteDevice(e){this.selectedDevice=e,this.confirmDeleteDialog=!0},async submitEdit(){try{const e=localStorage.getItem("token");await this.$api.put(`/device/${this.editForm.id}`,{nama_device:this.editForm.nama_device,uid_device:this.editForm.uid_device,mac_address:this.editForm.mac_address,latitude:this.editForm.latitude,longitude:this.editForm.longitude},{headers:{Authorization:`Bearer ${e}`}}),this.$q.notify({type:"positive",message:"Data device berhasil diperbarui!"}),this.editDialog=!1,this.fetchDevice(),this.$emit("update-success")}catch(e){console.error("Gagal update device:",e.response||e),this.$q.notify({type:"negative",message:"Gagal memperbarui data device"})}}},mounted(){this.fetchDevice();const e=JSON.parse(localStorage.getItem("user"));this.loggedInUserId=e?e.id_user:null,this.intervalId=setInterval(this.fetchAbsen,2e3)},computed:{user(){return JSON.parse(localStorage.getItem("user"))||{}}}};var r=a(2807),c=a(7716),u=a(3316),m=a(528),b=a(5262),g=a(3954),p=a(1693),k=a(2156),f=a(4189),v=a(9270),h=a(2669),_=a(492),F=a(8672),D=a(8582),y=a.n(D);const w=(0,r.A)(s,[["render",n]]),q=w;y()(s,"components",{QPage:c.A,QCard:u.A,QTable:m.A,QTd:b.A,QBadge:g.A,QBtn:p.A,QDialog:k.A,QCardSection:f.A,QInput:v.A,QCardActions:h.A,QIcon:_.A}),y()(s,"directives",{ClosePopup:F.A})}}]);